(function(e){"use strict";var t="app",n="value",r="$values",i="text",o="$shown",s="$deps",a="$attrs",u="$routes",c="$http",h="$tmpl",l="$form",d="_item_name",p="_fetched",f=[p,r,o,s,a,u,c,h,l,"$attr","$prop","$location"],v="data-index",b="data-tie",g="data-tied",y=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};Array.prototype._=function(e){return H.forEach(this,function(t){e.hasOwnProperty(t)||(e[t]={_item_name:t})}),e};var m=function(e){var t=function(t,n,i){if(n&&n._proxyMark)return!1;var s=function(){return n?n.get?n.get.call(t):n.value:t.$attr(i)},c=function(e){var t=s();return!H.isEqual(t,e)},h=function(s){if(c(s))if(n?n.set?n.set.call(this,s):n.value=s:t.$attr(i,s),i==o)e.show(s);else if(i==p){var h=m(e);h.length>0&&e.apply()}else i==a?e.prepareAttrs():i==u?e.prepareRoutes():i==r&&e.prepareValues(),H.debug("Calling apply on '"+e.name+"' after changed property '"+i+"'"),e.apply(i)},l=n?n.enumerable:!1;return Object.defineProperty(t,i,{get:s,set:h,configurable:!0,enumerable:l,_proxyMark:!0}),!0},n=function(i){var o=[];return H.forIn(i,function(l,d){if(h.push(d),"prototype"==d)return!1;var p=Object.getOwnPropertyDescriptor(i,d);if(p._proxyMark)return!1;if(!p.configurable||void 0===p.value&&!p.set||p.writable===!1)return!1;var f="$"===d.charAt(0)&&-1!=e.depends.indexOf(d.substring(1));return H.isObject(l)&&!f&&d!=a&&d!=u&&d!=s&&d!=r&&d!=c&&(H.debug("Exploring "+d),n(l)),H.debug("Observing "+d),t(i,p,d,f)&&o.push(d),!0}),i.$attrs&&H.forIn(i.$attrs,function(e,n){-1==h.indexOf(n)&&(e.property||e.value)&&(H.debug("Observing attribute "+n),t(i,null,n)&&o.push(n),h.push(n))},this),o},i=e.obj,h=[];return H.debug("Exploring "+e.name),n(i)},$={list:{},init:function(e){e.obj.$routes&&(H.forIn(e.obj.$routes,function(e,t){t=t.toLowerCase(),this.list[t]=new j(t,e.handler)},this),H.debug("Routes init"))},locate:function(t){var n=e.location.hash.substring(1);if(n=this.find(n)){H.debug("Process route "+n.path);var r=this;K.$location=function(t){return t?(r.move(t),null):{href:e.location.href,route:n}},n.handler&&z(n.handler,K.obj),H.forIn(t,function(e){var t=e.obj;t.$location=K.$location;var r=n.has(t);t.$shown=r,e.rendered||e.render(),e.validateShow();var i=t.$routes;if(i&&r){var o=i[n.path];o&&o.handler&&z(o.handler,t)}}),H.debug("Processed route "+n.path)}else K.obj.$routes?this.move("/"):(H.debug("Process default route"),H.forIn(t,function(e){e.rendered||e.render(),e.obj.$location=function(){return{route:{has:function(){return!0}}}},e.obj.$shown=!0}),H.debug("Processed default route"))},find:function(e){return this.list[e]},move:function(t){setTimeout(function(){e.location.hash="#"+t},100)}},j=function(e,t){this.path=e,this.handler=t};j.prototype={has:function(e){var t=e.$routes;if(t){var n=null!=t["-"],r=!1;return H.forIn(t,function(e,t){return t.toLowerCase()==this.path?(r=!0,!1):!0},this),n!=r}return!1}};var x={},E=function(e,t,n){if(H.isUndefined(t))return x[e];var r={fetchModel:!1,updateModel:!1,updateRoutes:!1};H.isDefined(n)&&H.extend(r,n);var i={fn:t,opts:r},o=new V(i);return x[e]=o,o},w=function(e){var t=e.indexOf(":");if(this.name=H.trim(t+1?e.substr(0,t):e),this.params="",t>=0){var n=H.trim(e.substr(++t));n="["+n+"]",this.params=n}};w.prototype={process:function(e,t,n){var r=this.name;H.debug("Process pipe "+r);var i=x[r];if(!i)throw Error("Pipe "+r+" not found");var o=i.fn,s=[];if(this.params.length>0){var a=H.extend({},e);a=H.extend(a,i);var u=H.convert(this.params,a);H.forEach(u,function(e){e=H.trim(e),s.push(e)})}var c=e;return o&&H.isFunction(o)&&(c=z(o,i,!0,c,s,t,n)),H.debug("Ready pipe "+r),c},fetchModel:function(){var e=x[this.name];return e?e.opts.fetchModel:!1},updateModel:function(){var e=x[this.name];return e?e.opts.updateModel:!1},updateRoutes:function(){var e=x[this.name];return e?e.opts.updateRoutes:!1}};var O={type:"GET",mime:"json"},A={script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},C=function(e){this.memoize={},this.cache=!0,e&&(e.url&&(this.url=e.url),e.params&&(this.params=e.params),e.headers&&(this.headers=e.headers),e.dataType&&(this.dataType=e.dataType),H.isDefined(e.cache)&&(this.cache=e.cache))},S=function(e,t){var n,r,i=e.xhr,o=i.status;return o>=200&&300>o||0===o?r=U(e,i,t):(r=i.responseText,n=o),[r,n]},I=function(e,t,n){e.done(t,n)},P=function(e,t,n,r){r&&(t["Content-Type"]=r),n&&(t.Accept=A[n]),H.forIn(t,function(t,n){e.setRequestHeader(n,t)})},T=function(e,t,n,r,i,o){return function(){if(4===t.readyState){H.debug("Process response");var s=S(e,r),a=s[0],u=s[1];!u&&H.isObject(a)&&i===O.type&&o.cache&&o.memo(n,r,a),I(e,a,u)}return null}},U=function(e,t,n){var r;if(r=t.responseText)if(n===O.mime)try{r=JSON.parse(r)}catch(i){I(e,r,i)}else"xml"===n&&(r=t.responseXML);return r},_=function(e,t,n){var r=n;if(K&&K.connect&&K.connect[t]){var i=K.connect[t];r=H.isObject(r)?H.extend(r,i):o}var o=e[t];return o&&(r=H.isObject(r)?H.extend(r,o):o),r},R=function(e,t){this.xhr=e,this.ready=!1,this.fn=t};R.prototype={cancel:function(){this.xhr&&this.xhr.abort(),this.ready=!1,delete this.data,delete this.err},done:function(e,t){this.ready=!0,this.data=e,this.err=t,this.fn?z(this.fn,this,!0,e,t):console.log("Response received:"+e)}};var D=function(e){return function(t,n){n?console.error(n):H.isObject(t)?(H.extend(e,t),e._fetched=!0):console.log("Response received:"+t)}},N=function(e,t){if(!e)return e;var n=e.indexOf("?"),r=e.substring(0,n+1?n:e.length),i=r.split("/");return H.forEach(i,function(n){if(":"===n[0]){var r=n.substr(1),i=t[r];H.isDefined(i)&&(e.replace(n,i),delete t[r])}}),e},k=function(e,t){t&&(e.params?H.extend(e.params,t):e.params=t)},F=function(e,t){var n="";t&&(n=t.indexOf("?")+1?"&":"?");var r=n;return H.forIn(e,function(e,t){r!==n&&(r+="&"),r+=t+"="+e}),r===n?"":r},q=function(t,n,r){var i=t.getType(),o=t.getUrl(),s=t.getParams(),a=t.getDataType(),u=t.getContentType(),c=t.getHeaders(),h=null;if(o=N(o,s),H.debug("Ajax call to "+o),i===O.type?(o+=F(s,o),t.cache&&!r&&(h=t.memo(o,a))):s=F(s),/=\$JSONP/gi.test(o))return this.jsonp(o,data);var l=new e.XMLHttpRequest,d=null;H.isFunction(n)?d=n:H.isObject(n)&&(d=D(n));var p=new R(l,d);if(h)H.debug("Got cached result"),I(p,h,null);else{l.onreadystatechange=T(p,l,o,a,i,t),l.open(i,o),P(l,c,u,a);try{H.debug("Send request"),l.send(s)}catch(f){l=f,I(p,null,f)}}return p},M=function(t,n,r){var i=t.url,o=t.params,s=e.document.getElementsByTagName("head")[0],a=e.document.createElement("script");i=N(i,o),i+=F(o,i),H.debug("JSONP call to "+i);var u=null;t.cache&&!r&&(u=t.memo(i,O.mime));var c=null;H.isFunction(n)?c=n:H.isObject(n)&&(c=D(n));var h=new R(null,c);if(u)H.debug("Got cached result"),h.done(u,null);else{var l="jsonp"+H.uid();e[l]=function(n){return s.removeChild(a),delete e[l],H.debug("Process response"),t.memo(i,O.mime,n),h.done(n,null)},H.debug("Create JSONP request"),a.type="text/javascript",a.src=i.replace(/=\$JSONP/gi,"="+l),s.appendChild(a)}return h},L=function(e,t,n,r){return e.type=t,e.contentType="application/x-www-form-urlencoded",k(e,n),q(e,r)};C.prototype={jsonp:function(e,t,n,r){var i=H.extend({},this);return i.url=e,i.params=t,M(i,n,r)},get:function(e,t,n){return this.type=O.type,delete this.contentType,k(this,e),q(this,t,n)},post:function(e,t){return L(this,"POST",e,t)},put:function(e,t){return L(this,"PUT",e,t)},"delete":function(e,t){return L(this,"DELETE",e,t)},getUrl:function(){var e=_(this,"url","");if(!e)throw Error("URL is not defined");return e},getParams:function(){return _(this,"params",{})},getType:function(){return _(this,"type",O.type)},getContentType:function(){return _(this,"contentType",null)},getDataType:function(){return _(this,"dataType",O.mime)},getHeaders:function(){return _(this,"header",{})},memo:function(e,t,n){var r=e+t;return H.isDefined(n)&&(this.memoize[r]=n),this.memoize[r]}};var J={next:function(e,t){var n=e.parentNode;H.forEach(t,function(t){n.insertBefore(t,e.nextSibling),e=t})},remove:function(e){var t=e.parentNode;t&&t.removeChild(e)},ready:function(t){"complete"===document.readyState?setTimeout(t,0):e.addEventListener("load",t),e.addEventListener("hashchange",t)}},B=function(e,t){var n=this,r=function(r){H.debug("Fired '"+r.type+"' listener on '"+t.name+"' for element "+e.tagName);var i=n.value();i=H.trim(i),n.pipes.length>0?n.pipeline(function(){},i):t.obj.value!==i&&(t.obj.value=i)},i=e.getAttribute(v);this.$=e,this._id=H.uid(),this.index=i?parseInt(i):-1,this.tie=e.getAttribute(b),this.bind=t,this.events={},this.isInput=H.eqi(e.tagName,"input"),this.hasCheck=H.eqi(e.type,"radio")||H.eqi(e.type,"checkbox"),this.display=e.style.display,this.shown=!0,this.textEl=null,this.isInput&&(this.hasCheck?(H.debug("Added change listener on '"+t.name+"' for element "+e.tagName),e.addEventListener("change",r)):"oninput"in e?(H.debug("Added input listener on '"+t.name+"' for element "+e.tagName),e.addEventListener("input",r)):(H.debug("Added keydown listener on '"+t.name+"' for element "+e.tagName),e.addEventListener("keydown",function(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||r(e)})));var o=this.tie.replace(/\.([^.|]+(\.[^.|]+)*)/g,'|property:"$1"').match(/[^|]+/g).splice(1);this.pipes=[],H.forEach(o,function(e){this.pipes.push(new w(e))},this),this.pipeline=function(e,t){var n=this.bind.obj;this.bind;var r=n;this.pipes.length>0?H.sequence(this.pipes,function(e,i){var o,s=function(o){r=o,e.updateRoutes()&&H.isUndefined(t)&&H.isFunction(r.$location)&&(r.$shown=r.$location().route.has(r)),(H.isDefined(t)&&e.updateModel()||e.fetchModel()&&H.isUndefined(t))&&(H.extend(n,o),r._fetched=n._fetched=!0),i(r)},a=H.clone(r);o=H.isDefined(t)?e.process(a,s,t):e.process(a,s),o&&s(o)},function(){e&&e(r)}):e(r)}};B.prototype={setAttribute:function(e,t){if(n===e)this.value(t);else if(i===e)this.text(t);else if(H.isFunction(t)){var r=this.events[e];r&&this.$.removeEventListener(e,r);var o=this;r=function(e){e.index=o.index,e.tie=o.tie,z(t,o.bind.obj,o.bind.obj.$ready(),e)},this.events[e]=r,this.$.addEventListener(e,r)}else H.isDefined(t)?this.$.setAttribute(e,t):this.$.setAttribute(e,"")},value:function(e){if(this.hasCheck){if(!H.isDefined(e))return this.$.checked;e?this.$.setAttribute("checked","checked"):this.$.removeAttribute("checked")}else{if(!this.isInput)return this.text(e);if(!H.isDefined(e))return this.$.value;this.$.value=e}return null},text:function(t){return H.isDefined(t)?(this.isInput?(null==this.textEl&&(this.textEl=e.document.createElement("span"),this.next(this.textEl)),this.textEl.textContent=t):this.$.textContent=t,null):this.isInput?this.$.nextSibling.textContent||"":this.$.textContent||""},remove:function(){var e=this.$,t=this.bind.$;t.splice(t.indexOf(this),1),delete this.$,delete this.bind,delete this._id,delete this.isInput,delete this.hasCheck,delete this.events,J.remove(e)},next:function(e){var t=this.$;J.next(t,e)},show:function(e){this.shown!==e&&(e?(this.$.style.display=this.display,null!=this.textEl&&(this.textEl.style.display=this.display)):(this.display=this.$.style.display,this.$.style.display="none",null!=this.textEl&&(this.textEl.style.display="none")),this.shown=e)}};var H={debugEnabled:!1,isUndefined:function(e){return void 0==e},isDefined:function(e){return void 0!=e},isObject:function(e){return null!=e&&"object"==typeof e},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isDate:function(e){return"[object Date]"==Object.prototype.toString.apply(e)},isArray:function(e){return Array.isArray(e)||"[object Array]"==Object.prototype.toString.apply(e)},isCollection:function(e){return this.isArray(e)||e instanceof Array||"[object NodeList]"==Object.prototype.toString.apply(e)||"[object NamedNodeMap]"==Object.prototype.toString.apply(e)||"[object Arguments]"==Object.prototype.toString.apply(e)},isFunction:function(e){return"function"==typeof e},isBoolean:function(e){return"boolean"==typeof e},trim:function(e){return this.isString(e)?e.replace(/^\s*/,"").replace(/\s*$/,""):e},lowercase:function(e){return this.isString(e)?e.toLowerCase():e},uppercase:function(e){return this.isString(e)?e.toUpperCase():e},toInt:function(e){return parseInt(e,10)},toFloat:function(e){return parseFloat(e)},eqi:function(e,t){return this.lowercase(e)===this.lowercase(t)},isEqual:function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;var i=Object.prototype.toString.call(e);if(i!=Object.prototype.toString.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;this.isUndefined(n)&&(n=[]),this.isUndefined(r)&&(r=[]);for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;n.push(e),r.push(t);var s=0,a=!0;if("[object Array]"==i){if(s=e.length,a=s==t.length)for(;s--&&(a=this.isEqual(e[s],t[s],n,r)););}else{var u=e.constructor,c=t.constructor;if(u!==c&&!(this.isFunction(u)&&u instanceof u&&this.isFunction(c)&&c instanceof c))return!1;this.forIn(e,function(e,i){return s++,(a=t.hasOwnProperty(i)&&H.isEqual(e,t[i],n,r))?!0:!1}),a&&(this.forIn(t,function(){return s--?!0:!1}),a=!s)}return n.pop(),r.pop(),a},clone:function(e){if(!e||!this.isObject(e))return e;var t=this.isCollection(e)?[]:Object.create(Object.getPrototypeOf(e));return t=this.extend(t,e,function(e){return H.clone(e)})},convert:function(e,t){var n=e,r=function(e,n){return H.isString(n)&&"#"==n[0]?t[n.substring(1)]:n};return"true"===e?n=!0:"false"===e?n=!1:/^\d*$/.test(e)?n=-1!=e.indexOf(".")?this.toFloat(e):this.toInt(e):"["==e[0]&&"]"==e[e.length-1]?(e=e.replace(/'/g,'"'),n=JSON.parse(e,r)):"{"==e[0]&&"}"==e[e.length-1]?(e=e.replace(/'/g,'"'),n=JSON.parse(e,r)):('"'==e[0]||"'"==e[0])&&(n=e.substring(1,e.length-1)),n},forEach:function(e,t,n,r){if(n||(n=this),t)if(this.isCollection(e)){var i=-1,o=e.length,s=[];if(r){for(;o>++i;)s.push(e[i]);i=-1}else s=e;for(;o>++i&&t.call(n,s[i],i,e)!==!1;);}else t.call(n,e,0,[e]);return e},forIn:function(e,t,n,r){if(n||(n=this),t)for(var i in e)if((e.hasOwnProperty(i)||r)&&t.call(n,e[i],i,e)===!1)break;return e},sequence:function(e,t,n,r){var i=[];if(r||(r=this),t){if(this.isCollection(e))for(var o=-1,s=e.length;s>++o;)i.push(o);else i=Object.keys(e);var a=function(){var o=i.shift();if(0===o||o){var s=e[o];t.call(r,s,a)}else n&&n.call(r,e)};a()}},uid:function(){return y()+y()+"-"+y()+"-"+y()+"-"+y()+"-"+y()+y()+y()},extend:function(e,t,n){return this.isCollection(e)&&this.isCollection(t)?this.forEach(t,function(t,r){n&&(t=n(t,r)),e.push(t)}):this.forIn(t,function(t,r){n&&(t=n(t,r)),e[r]=t},this),e},debug:function(e,t){this.debugEnabled&&(t&&(console.groupEnd(),console.groupCollapsed(t)),console.log(e))}},V=function(e){this._fetched=!1,H.extend(this,e)};V.prototype=H,V.prototype.$attr=function(e,t){if(this.$attrs){var n=this.$attrs[e];if(H.isUndefined(t)){if(n)return n.val(this)}else n&&n.property?this.$prop(n.property,t):n&&this.$prop(e,t)}return null},V.prototype.$prop=function(e,t){for(var n=this,r=e.split("."),i=1,o=r.length;o>i;)if(n=n[r[i-1]],i++,H.isUndefined(n))return null;var s=r[o-1];return H.isUndefined(t)?n[s]:(n[s]=t,null)},V.prototype.$ready=function(){var e=!0;return H.forEach(this.$deps,function(t){var n=this["$"+t];return n._empty?(e=!1,!1):!0},this),e};var z=function(e,t,n){var r,i=3;H.isUndefined(n)&&H.isFunction(t.$ready)&&(n=t.$ready(),i=2);try{var o=Array.prototype.slice.call(arguments,i);r=e.apply(t,o)}catch(s){r=void 0,n&&(console.groupCollapsed("User code error"),console.error("Is ready and had an error:"+s.message),console.dir(s),console.groupEnd())}return r},G=function(e,t,r){H.isUndefined(r)&&(r=-1);var i=e.$values;return r>=0&&i&&H.isDefined(i[r][t])?i[r][t]:r>=0&&i&&n==t?i[r]:e.$prop(t)},X=function(e,t,n){var r=this.name,i=this.value,o=this.property;if(H.isUndefined(n)&&(n=e.$ready()),H.isFunction(i))return z(i,e,n);if(o&&H.isUndefined(i))return G(e,o,t);if(!r)throw Error("Where is your property?");return G(e,r,t)},W=function(e,t,n){this.name=e,this.touch=[],this.values={},this.depends=t||[],this.rendered=!1,this.rendering=!1,this.loaded=!1,this.loading=!1,this.selected=!1,this.applyCount=0,this.timeout=null,this.e=0,this.apply=function(e){if(this.applyCount++,this.applyCount>10&&H.debug("Too many apply :"+this.name+" - "+this.applyCount),this.rendered&&this.render(e),H.forEach(this.touch,function(e){var t=n[e];t&&(t.obj["$"+this.name]=this.obj)},this),!this.timeout){var t=this;this.timeout=setTimeout(function(){t.timeout=null,t.applyCount=0},3e3)}}};W.prototype={prepareRoutes:function(){var e=this.obj.$routes;e&&(H.isArray(e)&&(this.obj.$routes=e._({})),H.forIn(this.obj.$routes,function(e,t){e=H.isFunction(e)?{path:t,handler:e}:{path:t},this.obj.$routes[t]=e},this))},prepareAttrs:function(){var e=this.obj.$attrs;e&&(H.isArray(e)&&(this.obj.$attrs=e._({})),H.forIn(this.obj.$attrs,function(e,t){e=H.isString(e)&&"#"==e[0]?{name:t,property:e.substring(1)}:H.isFunction(e)?{name:t,value:e}:e[d]?{name:e[d]}:{name:t,value:e},e.val=X,this.obj.$attrs[t]=e},this))},prepareValues:function(){var e=this.obj.$values;if(e){if(this.$.length-this.e==e.length)return this.rendered=!1,void 0;var t={},n={};H.forEach(this.$,function(e){e.index>=0&&e.remove()},this,!0),H.forEach(e,function(e,r){H.forEach(this.$,function(e){var i=e._id,o=n[i];o||(n[i]=o=e.$);var s=t[i];s||(t[i]=s=[]);var a=o.cloneNode(!0);o.style.display="",a.setAttribute(v,r),s.push(a)})},this),H.forEach(this.$,function(e){var n=e.$;n.style.display="none",J.next(n,t[e._id])}),this.selected=!1}},show:function(e){this.rendered&&H.forEach(this.$,function(t){t&&t.show(e)},this)},validateShow:function(){this.loaded||this.loading||this.load();var e=this;H.forEach(this.$,function(t){t&&t.pipeline(function(n){var r=n.$shown;r&&!e.rendered&&e.render(),t.show(r)})})},render:function(e,t){if(this.obj.$shown&&(!this.rendering||t)){this.rendering=!0;var n=this.name;H.debug("Render "+n,n+" Render"),this.loaded||this.loading||this.load();var r=this.obj.$ready(),i=this.$.length,o=this,s=this.obj._fetched;H.forEach(this.$,function(e){e&&e.pipeline(function(t){var a=t.$attrs,u=e.index;a&&(H.forIn(a,function(n){var i=n.val(t,u,r),o=n.name;H.debug("Render attribute '"+o+"' with value "+i),e.setAttribute(o,i)}),e.setAttribute(g),e.isInput&&e.setAttribute("name",n)),0==--i&&(o.rendering=!1,o.rendered=!0,H.debug("Rendered "+n)),t._fetched&&!s&&(s=!0,o.render(null,!0))})}),0==i&&(this.rendering=!1,this.rendered=!0,H.debug("Rendered "+n))}}};var K=null,Q=function(){var n={};return function(r,i,o){if(-1!=f.indexOf("$"+r))throw Error(r+" is reserved. Please choose another name for your tie");r!=t&&null==n[t]&&e.tie(t,{});var s=n[r];if(!s||s.obj._empty||!H.isUndefined(o)&&s.depends!==o){var a=Q.prototype.init(r,i,o,n);return Q.prototype.define(r,a,n),r==t&&(K=a,$.init(K),J.ready(function(){$.locate(n)})),a.obj}return Q.prototype.update(s,i)}};Q.prototype={select:function(t,n){var r=e.document.querySelectorAll("["+b+'="'+t+'"]'),i=[];return H.forEach(r,function(e){i.push(new B(e,n))}),r=e.document.querySelectorAll("["+b+'^="'+t+'|"]'),H.forEach(r,function(e){i.push(new B(e,n))}),r=e.document.querySelectorAll("["+b+'^="'+t+' |"]'),H.forEach(r,function(e){i.push(new B(e,n))}),r=e.document.querySelectorAll("["+b+'^="'+t+'."]'),H.forEach(r,function(e){i.push(new B(e,n))}),n.selected=!0,i},wrapPrimitive:function(e){return{value:e,$attrs:[n]}},wrapFunction:function(e){return{$attrs:{value:e}}},wrapArray:function(e){return{$values:e,$attrs:[n]}},check:function(e){return H.isFunction(e)?e=this.wrapFunction(e):!H.isObject(e)||H.isDate(e)?e=this.wrapPrimitive(e):H.isArray(e)&&(e=this.wrapArray(e)),H.isUndefined(e.$shown)&&(e.$shown=!0),H.isUndefined(e.$attrs)&&(e.$attrs={}),H.isUndefined(e.$routes)&&null!=K&&K.obj.$routes&&(e.$routes=K.obj.$routes),e.$http=new C(e.$http),new V(e)},resolve:function(e,t,n){t&&H.forEach(t,function(t){var r=n[t];r||(r={name:t,touch:[],obj:{_empty:!0}},this.define(t,r,n)),e.obj["$"+t]=r.obj,-1==r.touch.indexOf(e.name)&&r.touch.push(e.name)},this)},define:function(e,t,n){var r=n[e];n[e]=t,r&&r.touch&&(t.touch=r.touch,t.rendered=r.rendered,H.debug("Calling apply on '"+t.name+"' after define"),t.apply())},update:function(e,t){var n=e.name;return H.debug("Update tie "+n,n),H.extend(e.obj,this.check(t)),e.prepareAttrs(),e.prepareRoutes(),e.prepareValues(),H.debug("Prepared inner array structure"),m(e),e.selected||(this.$=Q.select(n,e),H.debug("Elements reselected: "+this.$.length)),e.rendered||e.render(),e},init:function(e,t,n,r){H.debug("Tie "+e,e);var i=new W(e,n,r);i.obj=this.check(t),i.prepareAttrs(),i.prepareRoutes(),this.resolve(i,n,r),i.obj.$deps=i.depends,m(i),H.debug("Bind model ready");var o=this;return i.load=function(){this.loading=!0,this.selected||(this.$=o.select(e,i),this.e=this.$.length,H.debug("Elements selected: "+this.$.length)),i.prepareValues(),H.debug("Prepared inner array structure"),this.selected||(this.$=o.select(e,i),H.debug("Elements reselected: "+this.$.length)),this.loaded=!0,this.loading=!1},i}},e.tie=Q(),e.tie.pipes=E,e.tie.enableDebug=function(e){H.debugEnabled=e},E("property",function(e,t,r,i){if(t&&t.length>0){var o=t[0],s=t.length>1?t[1]:n;H.isUndefined(i)?e.$prop(s,e.$prop(o)):e.$prop(o,i)}return e},{updateModel:!0}),E("value",function(e,t){if(t&&t.length>0){var n=t[0],r=t.length>1?t[1]:null;e.$prop(n,r)}return e}),E("routes",function(e,t){if(t&&t.length>0){var n="+"===t[0],r="-"===t[0];n?(t.splice(0,1),this.forEach(t,function(t){e.$routes[t]={path:t}})):r?(t.splice(0,1),this.forEach(t,function(t){delete e.$routes[t]})):(e.$routes={},this.forEach(t,function(t){e.$routes[t]={path:t}}))}return e},{updateRoutes:!0});var Y=function(e,t,n){if(e._fetched)return e;var r={};if(t&&t.length>0){var i=this.trim;this.forEach(t,function(e){var t=e.split(":");r[i(t[0])]=2==t.length?i(t[1]):""})}return e.$http.get(r,function(t,r){r?console.error(r):H.isObject(t)?H.extend(e,t):console.log("Response received:"+t),n(e)}),null};E("load",Y),E("fetch",Y,{fetchModel:!0})})(window);