!function(e){function t(e){for(var t={},n=e.split(","),r=0;r<n.length;r++)t[n[r]]=!0;return t}var n=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,r=/^<\/([-A-Za-z0-9_]+)[^>]*>/,a=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,s=t("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),i=t("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),l=t("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),o=t("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),d=t("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),u=t("script,style"),c=function(e,t){function c(e,n,r,u){if(n=n.toLowerCase(),i[n])for(;m.last()&&l[m.last()];)f("",m.last());if(o[n]&&m.last()==n&&f("",n),u=s[n]||!!u,u||m.push(n),t.start){var c=[];r.replace(a,function(e,t){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:d[t]?t:"";c.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"')})}),t.start&&t.start(n,c,u)}}function f(e,n){if(n)for(r=m.length-1;r>=0&&m[r]!=n;r--);else var r=0;if(r>=0){for(var a=m.length-1;a>=r;a--)t.end&&t.end(m[a]);m.length=r}}var p,h,g,m=[],b=e;for(m.last=function(){return this[this.length-1]};e;){if(h=!0,m.last()&&u[m.last()])e=e.replace(new RegExp("(.*)</"+m.last()+"[^>]*>"),function(e,n){return n=n.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),t.text&&t.text(n),""}),f("",m.last());else if(0==e.indexOf("<!--")?(p=e.indexOf("-->"),p>=0&&(e=e.substring(p+3),h=!1)):0==e.indexOf("</")?(g=e.match(r),g&&(e=e.substring(g[0].length),g[0].replace(r,f),h=!1)):0==e.indexOf("<")&&(g=e.match(n),g&&(e=e.substring(g[0].length),g[0].replace(n,c),h=!1)),h){p=e.indexOf("<");var v=0>p?e:e.substring(0,p);e=0>p?"":e.substring(p),t.text&&t.text(v)}if(e==b)throw"Parse Error: "+e;b=e}f()},f=function(e){var t=[],n=[];return c(e,{start:function(e,t){for(var r={$tag:e,$children:[]},a=0;a<t.length;a++)r[t[a].name]=t[a].value;n.push(r)},end:function(){var e=n.pop();0==e.$children.length&&delete e.$children,0==n.length?t.push(e):n[n.length-1].$children.push(e)},text:function(e){var t=n[n.length-1];t&&(t.value=e)}}),t};e.tie.pipe("html",function(e,t){return e.$view.$children=f(t[0]),e})}("object"==typeof exports?module:window);