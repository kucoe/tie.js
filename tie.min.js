!function(e){"use strict";function t(e){return new RegExp("^"+e+"$")}var n="app",i="value",r="$deps",s="$$",o="$",a=null,u=function(e,t){return[].slice.call(e,t)},l=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)},c={debugEnabled:!1,isUndefined:function(e){return void 0==e},isDefined:function(e){return void 0!=e},isObject:function(e){return null!=e&&"object"==typeof e},isString:function(e){return"string"==typeof e||"[object String]"=={}.toString.apply(e)},isNumber:function(e){return"number"==typeof e||"[object Number]"=={}.toString.apply(e)},isDate:function(e){return"[object Date]"=={}.toString.apply(e)},isRegExp:function(e){return"[object RegExp]"=={}.toString.apply(e)},isArray:function(e){return Array.isArray(e)||"[object Array]"=={}.toString.apply(e)},isCollection:function(e){var t={}.toString.apply(e);return this.isArray(e)||e instanceof Array||"[object NodeList]"==t||"[object NamedNodeMap]"==t||"[object Arguments]"==t},isFunction:function(e){return"function"==typeof e},isBoolean:function(e){return"boolean"==typeof e||"[object Boolean]"=={}.toString.apply(e)},trim:function(e){return this.isString(e)?e.replace(/^\s*/,"").replace(/\s*$/,""):e},lowercase:function(e){return this.isString(e)?e.toLowerCase():e},uppercase:function(e){return this.isString(e)?e.toUpperCase():e},toInt:function(e){return parseInt(e,10)},toFloat:function(e){return parseFloat(e)},eqi:function(e,t){return this.lowercase(e)===this.lowercase(t)},isEqual:function(e,t){if(e===t)return!0;if(this.isUndefined(e)||null==e||this.isUndefined(t)||null==t)return!1;if(typeof e!=typeof t)return!1;if(this.isDate(e)&&this.isDate(t))return e.getTime()===t.getTime();if(this.isRegExp(e)&&this.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(this.isFunction(e)&&this.isFunction(t))return e.toString()==t.toString();if(!this.isObject(e)&&!this.isObject(t))return e==t;if(e.prototype!==t.prototype)return!1;try{var n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;n.sort(),i.sort();var r;for(r=n.length-1;r>=0;r--)if(n[r]!=i[r])return!1;var s;for(r=n.length-1;r>=0;r--)if(s=n[r],!this.isEqual(e[s],t[s]))return!1}catch(o){return!1}return!0},clone:function(e){if(!e||!this.isObject(e))return e;var t=this.isCollection(e)?[]:Object.create(Object.getPrototypeOf(e));return t=this.extend(t,e,function(e){return c.clone(e)})},convert:function(e,t){var n=e,i=function(e,n){return c.isString(n)&&"#"==n[0]?t[n.substring(1)]:n};return"true"===e?n=!0:"false"===e?n=!1:/^\d+$/.test(e)?n=-1!=e.indexOf(".")?this.toFloat(e):this.toInt(e):"["==e[0]&&"]"==e[e.length-1]?(e=e.replace(/'/g,'"'),n=JSON.parse(e,i)):"{"==e[0]&&"}"==e[e.length-1]?(e=e.replace(/'/g,'"'),n=JSON.parse(e,i)):('"'==e[0]||"'"==e[0])&&(n=e.substring(1,e.length-1)),n},forEach:function(e,t,n,i){if(n||(n=this),t)if(this.isCollection(e)){var r=-1,s=e.length,o=[];for(o=i?[].slice.call(e):e;++r<s&&t.call(n,o[r],r,o)!==!1;);}else t.call(n,e,0,[e]);return e},forIn:function(e,t,n,i){if(n||(n=this),t)for(var r in e)if((e.hasOwnProperty(r)||i)&&t.call(n,e[r],r,e)===!1)break;return e},sequence:function(e,t,n,i){var r=[];if(i||(i=this),t){if(this.isCollection(e))for(var s=-1,o=e.length;++s<o;)r.push(s);else r=Object.keys(e);var a=function(){var s=r.shift();if(0===s||s){var o=e[s];t.call(i,o,a)}else n&&n.call(i,e)};a()}},safeCall:function(e,t,n){var i,r=3;this.isUndefined(n)&&this.isFunction(t.$ready)&&(n=t.$ready(),r=2);try{var s=u(arguments,r);i=e.apply(t,s)}catch(o){i=void 0,n&&(console.error("Is ready and had an error:"+o.message),c.debug(o,"User code error"))}return i},define:function(e,t,n,i){this.defineImmutable(e,"$name",t),this.defineImmutable(e,"$sealed",n||!1),this.defineImmutable(e,"$deps",Object.freeze(i||[])),this.defineImmutable(e,"_uid",this.uid())},defineImmutable:function(e,t,n){Object.defineProperty(e,t,{value:n,configurable:!1,writable:!1,enumerable:!0,_proxyMark:!0})},uid:function(){return l()+l()+"-"+l()+"-"+l()+"-"+l()+"-"+l()+l()+l()},extend:function(e,t,n){return this.isCollection(e)&&this.isCollection(t)?this.forEach(t,function(t,i){[].push.call(e,n?n(t,i):t)}):this.forIn(t,function(t,i){e[i]=n?n(t,i):t},this),e},nextTick:function(t){"function"==typeof e.setImmediate?e.setImmediate(t):"undefined"!=typeof process&&process.nextTick?process.nextTick(t):e.setTimeout(t,0)},debug:function(e,t){this.debugEnabled&&(t&&console.groupCollapsed&&(console.groupEnd(),console.groupCollapsed(t)),console.log(e))}},d={},h=function(e,t,n,i){var r=d[e];if(c.isUndefined(t))return r;if(r&&r.$sealed)throw new Error(e+" pipe already registered and sealed. Please choose another name for your pipe");if(!e||"."==e[0])throw new Error(e+" is not valid name for your pipe");return r=f(e,t,n||[]),c.define(r,e,i,n),r=c.extend(r,c),c.defineImmutable(r,"$async",3==t.length),d[e]=r,r},f=function(e,t,n){var i=function(r,o,a){if(c.debug("Process pipe "+e),c.forEach(n,function(e){i[s+e]=d[e]}),o&&o.length>0){var u=c.convert(o,r);o=[],c.forEach(u,function(e){e=c.trim(e),o.push(e)})}return t&&c.isFunction(t)&&(r=c.safeCall(t,i,!0,r,o,a)),c.debug("Ready pipe "+e),r};return i},p=function(e){return c.isString(e)?e=d[e]:c.isFunction(e)&&(e=h("%tmp%",e)),e},v=function(e){return e=c.clone(e),g(e),y(e)},y=function(e){function t(){var e=n.shift();return function(t){c.nextTick(function(){e&&e(t)})}}var n=[],i=!1,r=function(){if(0==arguments.length)return e;var s=arguments[0];if(s=p(s),!s)throw new Error("Pipe "+arguments[0]+" not found");var o=u(arguments,1),a=function(n){e=n;var i=t();s.$async?s(e,o,i):(e=s(e,o),i(e))};return n.push(a),s.$async||i?(i||t()(e),i=!0):e=s(e,o),r};return r},g=function(e){var t=new j(e);t.apply=function(t,n){if(t&&t[0]==o){var i=t.substring(1),r=m[i];if(r){c.debug("Check handle "+i);var s=e[t],u=a?a.obj[i]:void 0;c.isUndefined(s)&&c.isDefined(u)&&(s=u),c.debug("Got handle config "+s),c.isDefined(s)&&(this.remove(r._uid),e[t]=r(e,s,this,u))}}t&&this.onChange(t,n)},t.observe()},b=function(e,t,n){e=c.trim(e||"");var i=e.split("|"),r=i[0],s=r.indexOf(".");return-1!=s?(i[0]=r.substring(s),r=r.substring(0,s)):i=i.splice(1),n=n?v(n):A(r),c.forEach(i,function(e){var t=b.prototype.parse(e),i=[t.name];i=c.extend(i,t.params),c.debug("Parsed pipe"+JSON.stringify(i)),n=n.apply(n,i)}),c.isFunction(t)?n.apply(n,[t]):n()};b.prototype={parse:function(e){var t=e.indexOf(":"),n={};if(n.name=c.trim(t+1?e.substr(0,t):e),n.params=[],"."==n.name[0]&&(n.params=[n.name.substring(1)],n.name="property",t=-1),t>=0){var i=c.trim(e.substr(++t));i="["+i+"]";var r=c.convert(i,{});c.forEach(r,function(e){e=c.trim(e),n.params.push(e)})}return n}};var m={},x=function(e,t,n,i){var r=m[e];if(c.isUndefined(t))return r;if(r&&r.$sealed)throw new Error(e+" handle already registered and sealed. Please choose another name for your handle");return r=$(e,t,n||[]),c.define(r,e,i,n),r=c.extend(r,c),m[e]=r,r},$=function(e,t,n){var i=function(r,o,a,u){return c.debug("Process handle "+e),c.forEach(n,function(e){i[s+e]=m[e]}),t&&c.isFunction(t)&&(r=c.safeCall(t,i,!0,r,o,a,u)),c.debug("Processed handle "+e),r};return i},w=function(){this.$prop=function(e,t){for(var n=this,i=e.split("."),r=1,s=i.length;s>r;)if(n=n[i[r-1]],r++,c.isUndefined(n))return void 0;var o=i[s-1];return c.isUndefined(t)?n[o]:(n[o]=t,void 0)},this.$ready=function(){var e=!0;return c.forEach(this.$deps,function(t){var n=this[s+t];return!n||n._empty?(e=!1,!1):!0},this),e}};w.prototype=c;var E=function(e){c.extend(this,e)};E.prototype=new w;var j=function(e){this.obj=e,this.props=[],this.newProps=[],this.listeners=[]};j.prototype={observe:function(){var e=this.obj,t=e.$ready();c.debug("Exploring object "+e.$name);var n=S(e,t,this);this.newProps.length>0&&(c.forEach(this.newProps,function(i){c.debug("Observing dynamic property "+i);for(var r=i.split("."),s=r.shift(),o=e,a="";s;){a+=s;var u=Object.getOwnPropertyDescriptor(o,s);o&&I(o,s,u,t,this,a)&&n.push(i),o=o[s],s=r.shift(),a+="."}},this),this.newProps=[]),c.forEach(this.props,function(e){c.debug("Check for property being deleted "+e),c.isUndefined(this.obj.$prop(e))&&(c.debug("Notify deleted property "+e),this.onDelete(e,t))},this),this.props=n},watch:function(e,n,i,r){if(e&&"*"!==e||(e=".*"),c.debug("Dynamic property listener: "+e),i||r){var s=O(t(e),n,null,i,r);return this.listeners.push(s),function(){var e=this.listeners.indexOf(s);-1!=e&&this.listeners.splice(e,1)}.bind(this)}return null},add:function(e,t,n){if(-1==this.props.indexOf(e)&&(this.newProps.push(e),this.props.length>0&&this.observe()),-1!=this.newProps.indexOf(e)&&n){c.debug("Dynamic property added: "+e);var i=O(e,t,n);return this.listeners.push(i),function(){var t=this.listeners.indexOf(i);-1!=t&&this.listeners.splice(t,1),t=this.newProps.indexOf(e),-1!=t&&this.newProps.splice(t,1)}.bind(this)}return null},remove:function(e){var t;c.isString(e)&&c.forEach(this.listeners,function(n,i){var r=n.property;e&&(r===e||c.isRegExp(r)&&r.test(e)||n.handlerId===e)&&(this.listeners.splice(i,1),t=this.newProps.indexOf(r),-1!=t&&this.newProps.splice(t,1))},this,!0)},onGet:function(e,t){return C(e,this.obj,t,this.listeners,"get")},onChange:function(e,t){return C(e,this.obj,t,this.listeners,"change")},onDelete:function(e,t){return C(e,this.obj,t,this.listeners,"del")},apply:function(e,t){this.onChange(e,t)}};var O=function(e,t,n,i,r){return{property:e,handlerId:t,valueFn:n,onChange:i,onDelete:r}},C=function(e,t,n,i,r){n||(n=t.$ready()),c.debug("React on "+r+" for "+e);var s="get"===r?null:t[e];return c.forEach(i,function(i){var o=i.property,a="get"===r?o===e:c.isRegExp(o)&&o.test(e);if(a){var u="get"===r?i.valueFn:"del"===r?i.onDelete:i.onChange;c.isFunction(u)&&(s=c.safeCall(u,t,n,t,e,s))}}),s},S=function(e,t,i,o){var a=[];return c.forIn(e,function(u,l){if("prototype"==l)return!0;var d=Object.getOwnPropertyDescriptor(e,l);if(d._proxyMark)return!0;if(!d.configurable||void 0===d.value&&!d.set||d.writable===!1)return!0;var h=0==l.indexOf(s)&&-1!=e.$deps.indexOf(l.substring(2)),f=o?o+"."+l:l;return c.isObject(u)&&!h&&l!=r&&l!==s+n&&(c.debug("Exploring object "+l),c.extend(a,S(u,t,i,f))),c.debug("Observing property "+l),I(e,l,d,t,i,f)&&(a.push(l),i.onChange(f,t)),!0}),a},I=function(e,t,n,i,r,s){if(n&&n._proxyMark)return!1;var o=function(){return n?n.get?n.get.call(this):n.value:r.onGet(s,i)},a=function(e){var t=o();return!c.isEqual(t,e)},u=function(e){a(e)&&(n&&(n.set?n.set.call(this,e):n.value=e),u._apply||(u._apply=!0,r.apply(s,i),u._apply=!1))},l=n?n.enumerable:!0;return Object.defineProperty(e,t,{get:o,set:u,configurable:!0,enumerable:l,_proxyMark:!0}),!0},T=function(e,t){this.name=e,this.reliers=[],this.processedHandles=[],this.applyCount=0,this.obj=t,this.observer=new j(t);var n=this;this.observer.apply=function(e,t){n.apply(e,t)}};T.prototype={apply:function(e,t){if(c.debug("Calling apply on '"+this.name+"' after changed property '"+e+"'"),e&&e[0]==o){var n=e.substring(1),i=m[n];i&&this.resolveHandle(this.obj,n,i)}e&&this.observer.onChange(e,t),c.forEach(this.reliers,function(e){var t=P[e];t&&(t.obj[s+this.name]=this.obj)},this)},resolveHandles:function(){var e=this.name,t=this.obj;e!=n&&(this.processedHandles=[],c.forIn(m,function(e,n){-1==this.processedHandles.indexOf(n)&&this.resolveHandle(t,n,e)},this))},resolveHandle:function(e,t,n){c.debug("Check handle "+t),c.forEach(n.$deps,function(t){if(-1==this.processedHandles.indexOf(t)){var n=m[t];n&&this.resolveHandle(e,t,n)}},this);var i=o+t,r=e[i],s=a?a.obj[i]:void 0;c.isUndefined(r)&&c.isDefined(s)&&(r=s),c.debug("Got handle config "+r),c.isDefined(r)&&(this.observer.remove(n._uid),e[i]=n(e,r,this.observer,s)),-1==this.processedHandles.indexOf(t)&&this.processedHandles.push(t)},checkApplyCount:function(){if(this.applyCount++,this.applyCount>10&&c.debug("Too many apply :"+this.name+" - "+this.applyCount),!this.timeout){var e=this;this.timeout=setTimeout(function(){e.timeout=null,e.applyCount=0},3e3)}}};var P={},A=function(e,t,i,r){e!=n&&null==P[n]&&A(n,{});var s=P[e];if(c.isUndefined(t))return v(s.obj);if(s&&s.obj.$sealed)throw new Error(e+" tie is already registered and sealed. Please choose another name for your tie");return s=A.prototype.init(e,t,i,r),A.prototype.define(e,s),e==n&&(a=s),s.obj};A.prototype={check:function(e){return(c.isFunction(e)||c.isArray(e)||c.isRegExp(e)||c.isBoolean(e)||c.isNumber(e)||c.isString(e)||c.isDate(e)||!c.isObject(e))&&(e={value:e}),new E(e)},resolveDependencies:function(e,t){var i=e.name;i!=n&&(e.obj[s+n]=a.obj,-1==a.reliers.indexOf(i)&&a.reliers.push(i)),t&&c.forEach(t,function(t){c.debug("Check dependency "+t);var n=P[t];n||(c.debug("Dependency stub "+t),n={name:t,reliers:[],obj:{_empty:!0}},this.define(t,n)),e.obj[s+t]=n.obj,-1==n.reliers.indexOf(i)&&n.reliers.push(i)},this)},define:function(e,t){var n=P[e];P[e]=t,n&&(n.obj._deleted=!0,n.reliers&&(t.reliers=n.reliers,c.debug("Calling apply on '"+t.name+"' after define"),t.apply("*")))},init:function(e,t,n,i){c.debug("Tie "+e,e);var r=this.check(t),s=new T(e,r);return c.define(r,e,i,n),r._deleted=!1,s.resolveHandles(),this.resolveDependencies(s,n),s.observer.observe(),c.debug("Bind model ready"),s}},e.tie=A,e.tie.pipe=h,e.tie.handle=x,e.tie.enableDebug=function(e){c.debugEnabled=e},e.tie.$=b,e.tie._=c,"object"==typeof e.exports&&(e.exports=function(t){var n=e.tie;return t&&(n.tier=A.prototype,n.util=c,n.model=E,n.ties=P,n.pipesRegistry=d,n.handlesRegistry=m,n.bind=T),n}),h("property",function(e,t){if(t&&t.length>0){var n=t[0],r=t.length>1?t[1]:i;e.$prop(r,e.$prop(n))}return e}),x("require",function(t,n){return c.isFunction(e.require)?e.require(n):console.error("Require is undefined"),n})}("object"==typeof exports?module:window),function(e){"use strict";var t=e.tie._,n=e.document,i="value",r="text",s="data-index",o="data-tie",a="data-tied",u="class",l="name",c={domReady:!1,readyListeners:[],fetched:[],readyFn:function(){t.forEach(this.readyListeners,function(e){setTimeout(e,100)}),this.domReady=!0},insertAfter:function(e,n){var i=e.parentNode;t.forEach(n,function(t){i.insertBefore(t,e.nextSibling),e=t})},remove:function(e){var t=e.parentNode;t&&t.removeChild(e)},hasClass:function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},addClass:function(e,t){this.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(this.hasClass(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},ready:function(t){return t&&("complete"===n.readyState?(setTimeout(t,0),this.domReady=!0):0==this.readyListeners.length&&e.addEventListener("load",this.readyFn.bind(this)),0==this.readyListeners.length&&e.addEventListener("hashchange",this.readyFn.bind(this)),this.readyListeners.push(t)),this.domReady},fetch:function(e,i){i||(this.fetched=[],i=n);var r=i.querySelectorAll(e);t.forEach(r,function(e){this.fetched.push(e)},this)}},d=function(e,n){var i=this,r=n.$name,a=e.tagName,u=function(e){t.debug("Fired '"+e.type+"' listener on '"+r+"' for element "+a);var s=i.value();s=t.trim(s);var o=i.getProperty();n.$prop(o)!==s&&n.$prop(o,s)},l=e.getAttribute(s);this.$=e,this._id=t.uid(),this.index=l?parseInt(l):-1,this.tie=e.getAttribute(o),this.events={},this.isSelect=t.eqi(a,"select"),this.isInput=t.eqi(a,"input")||t.eqi(a,"textarea")||this.isSelect,this.hasCheck=t.eqi(e.type,"radio")||t.eqi(e.type,"checkbox"),this.display=e.style.display,this.shown=!0,this.textEl=null,this.isInput&&(this.hasCheck||this.isSelect?(t.debug("Added change listener on '"+r+"' for element "+a),e.addEventListener("change",u)):"oninput"in e?(t.debug("Added input listener on '"+r+"' for element "+a),e.addEventListener("input",u)):(t.debug("Added keydown listener on '"+r+"' for element "+a),e.addEventListener("keydown",function(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||u(e)})))};d.prototype={getProperty:function(){var e=this.tie;e=t.trim(e||"");var n=e.split("|"),r=n[0],s=r.indexOf(".");if(-1!=s)return r.substring(s+1);var o=r.indexOf(":"),a=t.trim(o+1?r.substr(0,o):r);if("property"===a&&o>=0){var u=t.trim(r.substr(++o));u="["+u+"]";var l=t.convert(u,{});return l[0]}return i},isTied:function(){return this.$.getAttribute(a)},setAttribute:function(e,n,s){if(i===e)this.value(n);else if(r===e)this.text(n);else if(u===e)c.addClass(this.$,n);else if(t.isFunction(n)){var o=this.events[e];o&&this.$.removeEventListener(e,o);var a=this;o=function(e){e.index=a.index,e.tie=a.tie,t.safeCall(n,s,s&&s.$ready(),e)},this.events[e]=o,this.$.addEventListener(e,o)}else t.isDefined(n)?this.$.setAttribute(e,n):this.$.setAttribute(e,"")},value:function(e){var n=this.$;if(this.hasCheck){if(!t.isDefined(e))return n.checked;e?n.setAttribute("checked","checked"):n.removeAttribute("checked")}else if(this.isSelect){if(!t.isDefined(e))return n.options[n.selectedIndex].value;var i=[].slice.call(n.options);t.forEach(i,function(i,r){return t.isEqual(i.value,e)?(n.selectedIndex=r,!1):!0})}else{if(!this.isInput)return this.text(e);if(!t.isDefined(e))return n.value;n.value=e}return null},text:function(e){var i=this.$;return t.isDefined(e)?(this.isInput?(null==this.textEl&&(this.textEl=n.createElement("span"),this.insertAfter(this.textEl)),this.textEl.textContent=e):this.isSelect?t.forEach(i.options,function(n,r){return t.isEqual(n.text,e)?(i.selectedIndex=r,!1):!0}):i.textContent=e,null):this.isInput?i.nextSibling.textContent||"":this.isSelect?i.options[i.selectedIndex].text:i.textContent||""},html:function(e){var n=this.$;if(t.isDefined(e))this.isInput||this.isSelect||(n.innerHTML=e);else if(!this.isInput&&!this.isSelect)return n.innerHTML||"";return null},remove:function(){var e=this.$;delete this.$,delete this._id,delete this.isInput,delete this.hasCheck,delete this.events,c.remove(e)},insertAfter:function(e){var t=this.$;c.insertAfter(t,e)},show:function(e){this.shown!==e&&(e?(this.$.style.display=this.display,null!=this.textEl&&(this.textEl.style.display=this.display)):(this.display=this.$.style.display,this.$.style.display="none",null!=this.textEl&&(this.textEl.style.display="none")),this.shown=e)}};var h=function(e,n,i,r){this.name=e,n?(this.value=n,this.$get=function(){return n}):(this.deps=r||[],this.$get=function(e,n){return t.isFunction(i)?t.safeCall(i,e,n):e.$prop(i)}),this.$render=function(e,n,i){var r=this.name,s=this.value;t.isUndefined(s)&&(s=this.value=this.$get(e,n)),t.debug("Render attribute '"+r+"' with value "+s),i.setAttribute(r,s,e)}},f=function(e,t,n,i){var r=new h(e,null,t,n);return r.value=r.$get(i),r},p=function(e,n){if(t.isString(e)&&(-1!=e.indexOf("#")||"*"===e||"@"===e)){var r={};if("*"===e)return t.forIn(n,function(e,t){"$"!=t.charAt(0)&&"_"!=t.charAt(0)&&(r[t]=f(t,t,[t],n))}),r;var s=e.split("#"),o=s[0]||i,a=s[1]||i;return r[o]=a==i&&t.isFunction(n.value)?f(o,n.value,n.value.$deps,n):f(o,a,[a],n),r}return t.isFunction(e)?{value:f(i,e,e.$deps,n)}:t.isFunction(e)||t.isArray(e)||t.isRegExp(e)||t.isBoolean(e)||t.isNumber(e)||t.isString(e)||t.isDate(e)||!t.isObject(e)?{value:new h(i,e)}:(t.forIn(e,function(r,s){if(i===s&&t.isFunction(n.value))e[s]=f(i,n.value,[i],n);else if(t.isString(r)&&"#"===r.charAt(0)){var o=r.substring(1)||s;e[s]=f(s,o,[o],n)}else e[s]=!t.isFunction(r)||r.name!=i&&r.$name!=i?new h(s,r):f(s,r,r.$deps,n)}),e)},v={},y=function(e,n){t.isUndefined(n.$shown)&&(n.$shown=!0),n.$tie=e.$name,n._processedHandles=[],this.$=[],this.rendered=!1,this.rendering=!1};y.prototype={select:function(e,n){var i=e.$name,r=[];return(0==c.fetched.length||n)&&c.fetch("["+o+"]",n),t.forEach(c.fetched,function(t){0==t.getAttribute(o).indexOf(i)&&r.push(new d(t,e))}),r},$render:function(e,n,i){0==this.$.length&&(this.$=this.select(e),t.debug("Elements selected: "+this.$.length)),t.forEach(this.$,function(r){if(r)if(i){var s=e.$prop("$view."+i);s&&t.isFunction(s.$render)&&s.$render(e,n,r)}else t.forIn(e.$view,function(i){t.isFunction(i.$render)&&i.$render(e,n,r)},this);i||(r.setAttribute(a),r.setAttribute(u,e.$name),r.isInput&&r.setAttribute(l,e.$name))},this)},render:function(e,n){if((this.rendered||!n)&&!this.rendering){this.rendering=!0;var i=e.$name;t.debug("Render "+i,i+" Render");var r=e.$ready();this.$render(e,r,n),this.rendering=!1,this.rendered=!0,t.debug("Rendered "+i)}},notify:function(e,n){var i=e.$ready();t.forIn(e.$view,function(r){if(r instanceof h){var s=r.deps||[];-1!=s.indexOf(n)&&t.forEach(this.$,function(t){r.value=r.$get(e,i),r.$render(e,i,t)})}},this)},show:function(e){this.rendered&&t.forEach(this.$,function(t){t&&t.show(e)},this)}};var g=e.tie.handle,b={},m=function(e,n,i,r){var s=b[e];if(t.isUndefined(n))return s;if(s&&s.$sealed)throw new Error(e+" view handle already registered and sealed. Please choose another name for your handle");return s=function(r,o){return t.debug("Process view handle "+e),t.forEach(i||[],function(e){s["$$"+e]=b[e]}),n&&t.isFunction(n)&&(r=t.safeCall(n,s,!0,r,o)),t.debug("Processed view handle "+e),r},t.define(s,e,r,i),s=t.extend(s,t),b[e]=s,s},x=function(){t.debug("Render app"),t.forIn(v,function(e){e.rendered||e.render()}),t.debug("Rendered app")},$=function(e,n){var i=b[n];if(i){t.forEach(i.$deps,function(t){-1==e._processedHandles.indexOf(t)&&$(e,t)});var r=e["$"+n];t.debug("View handle "+n+" with config"+r),t.isDefined(r)&&(e["$"+n]=i(e,r)),-1==e._processedHandles.indexOf(n)&&e._processedHandles.push(n)}};g("view",function(e,n,i){var r=this._uid,s=p(n,e),o=new y(e,s);return v[e.$name]=o,i.watch(".*",r,function(e,t,n){if(!o.silent)if("_deleted"===t&&n)delete v[e.$name],i.remove(r);else if(0==t.indexOf("$view.")){var a=t.replace("$view.","");if(a&&"$"==a[0]){var u=a.substring(1);$(s,u)}}else o.notify(e,t)}),t.forIn(b,function(e,t){-1==s._processedHandles.indexOf(t)&&$(s,t)},this),c.ready()&&setTimeout(function(){o.render(e)},100),s},[],!0),m("shown",function(e,t){var n=v[e.$name];return n&&n.show(t),t},[],!0),c.ready(x),Function.prototype.val=function(e){return t.define(this,i,!1,e||[i]),this},e.tie.domReady=c.ready,e.tie.viewHandle=m,"object"==typeof e.exports&&(e.exports=function(){var e={};return e.q=c,e.el=d,e.renders=v,e.clean=function(){c.fetched=[],e.renders=v={}},e})}(window),function(e){"use strict";var t=e.tie._,n={type:"GET",mime:"json"},i={script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},r=function(e,n,r,s){r&&(n["Content-Type"]=r),s&&(n.Accept=i[s]),t.forIn(n,function(t,n){e.setRequestHeader(n,t)})},s=function(e,i,r,s,a){return function(){var u=e.xhr;if(4===u.readyState){t.debug("Process response");var l,c,d=u.status;d>=200&&300>d||0===d?c=o(e,r):(c=u.responseText,l=d),!l&&t.isObject(c)&&s===n.type&&a.cache&&a.memo(i,r,c),e.done(c,l)}return null}},o=function(e,t){var i=e.xhr,r=i.responseText;if(r)if(t===n.mime)try{r=JSON.parse(r)}catch(s){e.done(r,s)}else"xml"===t&&(r=i.responseXML);return r},a=function(e,t){this.xhr=e,this.ready=!1,this.fn=t};a.prototype={cancel:function(){this.xhr&&this.xhr.abort(),this.ready=!1,delete this.data,delete this.err},done:function(e,n){this.ready=!0,this.data=e,this.err=n,t.debug("Request ready with response:"+JSON.stringify(e)+" and error:"+n),this.fn?t.safeCall(this.fn,this,!0,e,n):console.log("Response received:"+e)}};var u=function(e,n){if(!e)return e;var i=e.indexOf("?"),r=e.substring(0,i+1?i:e.length),s=r.split("/");return t.forEach(s,function(i){if(":"===i[0]){var r=i.substr(1),s=n[r];t.isDefined(s)&&(e.replace(i,s),delete n[r])}}),e},l=function(e,n){var i="";n&&(i=n.indexOf("?")+1?"&":"?");var r=i;return t.forIn(e,function(e,t){r!==i&&(r+="&"),r+=t+"="+e}),r===i?"":r},c=function(e,i){var r={},s=e.app,o=s&&s.url?s.url:"";if(r.url=/\{url\}/gi.test(o)?o.replace(/\{url\}/gi,e.url||""):e.url?o+e.url:o,!r.url)throw new Error("URL is not defined");var a=s&&s.params?s.params:{};r.params=e.params?t.extend(a,e.params):a,i&&t.extend(r.params,i),r.url=u(r.url,r.params);var l=s&&s.headers?s.headers:{};return r.headers=e.headers?t.extend(l,e.headers):l,r.type=e.type?e.type:s&&s.type?s.type:n.type,r.contentType=e.contentType?e.contentType:s&&s.contentType?s.contentType:null,r.dataType=e.dataType?e.dataType:s&&s.dataType?s.dataType:n.mime,r},d=function(e){var n=null;return t.isFunction(e)?n=e:t.isObject(e)&&(n=function(n,i){i?console.error(i):t.isObject(n)?t.extend(e,n):console.log("Response received:"+n)}),n},h=function(i,o,u,c){var h=i.type,f=i.url,p=i.params,v=i.dataType,y=i.contentType,g=i.headers,b=null;if(t.debug("Ajax call to "+f),h===n.type?(f+=l(p,f),p=null,o.cache&&!c&&(b=o.memo(f,v))):p=l(p),/=\$JSONP/gi.test(f))return o.jsonp(f,p,u,c);var m=new e.XMLHttpRequest,x=new a(m,d(u));if(b)t.debug("Got cached result"),x.done(b,null);else{m.onreadystatechange=s(x,f,v,h,o),m.open(h,f),r(m,g,y,v);try{t.debug("Send request"),m.send(p)}catch($){x.done(null,$)}}return x},f=function(i,r,s,o){var c=i.url,h=i.params,f=e.document.getElementsByTagName("head")[0],p=e.document.createElement("script");c=u(c,h),c+=l(h,c),t.debug("JSONP call to "+c);var v=null;r.cache&&!o&&(v=r.memo(c,n.mime));var y=new a(null,d(s));if(v)t.debug("Got cached result"),y.done(v,null);else{var g="jsonp"+t.uid();e[g]=function(i){return f.removeChild(p),delete e[g],t.debug("Process response"),r.memo(c,n.mime,i),y.done(i,null)},t.debug("Create JSONP request"),p.type="text/javascript",p.src=c.replace(/=\$JSONP/gi,"="+g),f.appendChild(p)}return y},p=function(e,t,n,i){var r=c(e,n);return r.type=t,r.contentType="application/x-www-form-urlencoded",h(r,e,i)},v=function(e,n,i){this.memoize={},this.cache=!0,this.app=i,e&&n&&(e.url&&(this.url=e.url),e.params&&(this.params=e.params),e.headers&&(this.headers=e.headers),e.dataType&&(this.dataType=e.dataType),t.isDefined(e.cache)&&(this.cache=e.cache))};v.prototype={jsonp:function(e,t,n,i){var r={};return r.url=e,r.params=t,f(r,this,n,i)},get:function(e,t,i){var r=c(this,e);return r.type=n.type,r.contentType=null,h(r,this,t,i)},post:function(e,t){return p(this,"POST",e,t)},put:function(e,t){return p(this,"PUT",e,t)},"delete":function(e,t){return p(this,"DELETE",e,t)},memo:function(e,n,i){var r=e+n;return t.isDefined(i)&&(this.memoize[r]=i),this.memoize[r]}};var y=e.tie.handle;y("http",function(e,n,i,r){return new v(n,t.isDefined(e.$http),r)},["attrs"],!0)}(window);